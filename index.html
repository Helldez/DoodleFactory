import React, { useState, useEffect } from 'react';
import './App.css';

const banners = ['Banner1.PNG', 'Banner2.PNG', 'Banner3.PNG', 'Banner4.PNG'];

const App = () => {
  const [menuVisible, setMenuVisible] = useState(false);
  const [currentBannerIndex, setCurrentBannerIndex] = useState(0);
  const [bannerInterval, setBannerInterval] = useState(null);

  useEffect(() => {
    // Start banner rotation on component mount
    startBannerRotation();

    // Cleanup on component unmount
    return () => stopBannerRotation();
  }, []);

  const toggleMenu = () => {
    setMenuVisible(!menuVisible);
  };

  const changeBanner = (direction) => {
    setCurrentBannerIndex((prevIndex) => (prevIndex + direction + banners.length) % banners.length);
  };

  const startBannerRotation = () => {
    stopBannerRotation();
    const interval = setInterval(() => changeBanner(1), 5000);
    setBannerInterval(interval);
  };

  const stopBannerRotation = () => {
    if (bannerInterval) {
      clearInterval(bannerInterval);
    }
  };

  const handleNavLinkClick = (targetId) => {
    const targetElement = document.getElementById(targetId);
    const headerHeight = document.querySelector('header').offsetHeight;
    const targetPosition = targetElement.getBoundingClientRect().top + window.scrollY - headerHeight;

    window.scrollTo({
      top: targetPosition,
      behavior: 'smooth'
    });

    // Hide menu after clicking a link
    setMenuVisible(false);
  };

  return (
    <div className="App">
      <header className={`header ${menuVisible ? 'menu-visible' : ''}`}>
        <div className="title-container">
          <h1>Doodle Factory Lab</h1>
          <p className="slogan">Qui nascono progetti, emozioni, ricordi</p>
        </div>
        <button id="menu-toggle" className="menu-toggle" onClick={toggleMenu}>
          &#9776;
        </button>
        <nav className={`menu ${menuVisible ? 'show' : ''}`}>
          {['about', 'portraits', 'illustrations', 'wedding', 'favors', 'live_sketches'].map((section) => (
            <a key={section} href={`#${section}`} onClick={() => handleNavLinkClick(section)}>
              {section.charAt(0).toUpperCase() + section.slice(1).replace('_', ' ')}
            </a>
          ))}
        </nav>
      </header>

      <div className="banner-container">
        <img src={banners[currentBannerIndex]} alt="Banner" id="current-banner" />
        <button className="banner-arrow left" onClick={() => changeBanner(-1)}>&#9664;</button>
        <button className="banner-arrow right" onClick={() => changeBanner(1)}>&#9654;</button>
      </div>

      {['about', 'portraits', 'illustrations', 'wedding', 'favors', 'live_sketches'].map((section) => (
        <Section key={section} sectionId={section} />
      ))}

      <footer>
        <p>Contatti: email@example.com - Telefono: +39 123 456 789</p>
        <p>© 2024 Doodle Factory - Tutti i diritti riservati</p>
        <p>
          Seguimi su Instagram: <a href="https://instagram.com/doodle_factory_lab" target="_blank">@doodle_factory_lab</a>
        </p>
      </footer>
    </div>
  );
};

const Section = ({ sectionId }) => {
  const sectionTitles = {
    about: 'Chi sono',
    portraits: 'Ritratti',
    illustrations: 'Illustrazioni',
    wedding: 'Wedding',
    favors: 'Bomboniere',
    live_sketches: 'Ritrattini dal vivo'
  };

  const sectionContent = {
    about: (
      <>
        <img
          src="profiloDF1.jfif"
          alt="Profilo Doodle Factory"
          className="profile-image"
        />
        <p>Ciao, che bello che sei qui! Sono Marina, grafica e illustratrice freelance. Doodle Factory Lab è il mio laboratorio creativo...</p>
      </>
    ),
    portraits: (
      <>
        <p>I ritratti sono sempre mezzobusto e abbracciati, le linee sono morbide e tondeggianti...</p>
        <IllustrationGallery images={['Ritratto1.jfif', 'Ritratto2.jfif', 'Ritratto3.jfif', 'Ritratto4.jfif']} />
      </>
    ),
    illustrations: (
      <>
        <p>Le mie illustrazioni sono pensate per raccontare storie...</p>
        <IllustrationGallery images={['illustrazione1.jpg', 'illustrazione2.jpg', 'illustrazione3.jpg', 'illustrazione4.jpg']} />
      </>
    ),
    wedding: (
      <>
        <p>Celebra il giorno più bello con illustrazioni e decorazioni personalizzate...</p>
        <IllustrationGallery images={['wedding1.jpg', 'wedding2.jpg', 'wedding3.jpg', 'wedding4.jpg']} />
      </>
    ),
    favors: (
      <>
        <p>Le bomboniere illustrate sono piccoli regali che lasciano un grande ricordo...</p>
        <IllustrationGallery images={['bomboniera1.jpg', 'bomboniera2.jpg', 'bomboniera3.jpg', 'bomboniera4.jpg']} />
      </>
    ),
    live_sketches: (
      <>
        <p>Rendi speciale il tuo evento con ritrattini dal vivo...</p>
        <IllustrationGallery images={['live1.jpg', 'live2.jpg', 'live3.jpg', 'live4.jpg']} />
      </>
    )
  };

  return (
    <section id={sectionId} className="content-section">
      <h2>{sectionTitles[sectionId]}</h2>
      {sectionContent[sectionId]}
    </section>
  );
};

const IllustrationGallery = ({ images }) => {
  return (
    <div className="illustrations">
      {images.map((imgSrc, index) => (
        <img key={index} src={imgSrc} alt={`Illustration ${index + 1}`} className="illustration-image" />
      ))}
    </div>
  );
};

export default App;
